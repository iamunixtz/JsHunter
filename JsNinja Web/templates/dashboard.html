{% extends "base.html" %}

{% block title %}Dashboard - Rezon{% endblock %}

{% block content %}
<div class="dashboard-header">
    <h1><i class="fas fa-chart-line"></i> Dashboard Overview</h1>
    <div class="support-link">
        <a href="https://buymeacoffee.com/iamunixtz" target="_blank" class="btn btn-outline">
            <i class="fas fa-coffee"></i> Support the Project
        </a>
    </div>
</div>

<!-- Full Width Stats Grid -->
<div class="full-width-stats">
    <div class="stat-card-large">
        <div class="stat-icon">
            <i class="fas fa-folder"></i>
        </div>
        <div class="stat-content">
            <span class="stat-number">{{ stats.total_projects }}</span>
            <div class="stat-label">Total Projects</div>
        </div>
    </div>
    <div class="stat-card-large">
        <div class="stat-icon">
            <i class="fas fa-search"></i>
        </div>
        <div class="stat-content">
            <span class="stat-number">{{ stats.total_scans }}</span>
            <div class="stat-label">Total Scans</div>
        </div>
    </div>
    <div class="stat-card-large">
        <div class="stat-icon">
            <i class="fas fa-key"></i>
        </div>
        <div class="stat-content">
            <span class="stat-number">{{ stats.total_secrets }}</span>
            <div class="stat-label">Secrets Found</div>
        </div>
    </div>
    <div class="stat-card-large">
        <div class="stat-icon">
            <i class="fas fa-eye"></i>
        </div>
        <div class="stat-content">
            <span class="stat-number">{{ stats.total_monitors }}</span>
            <div class="stat-label">JS Monitors</div>
        </div>
    </div>
    <div class="stat-card-large">
        <div class="stat-icon">
            <i class="fas fa-link"></i>
        </div>
        <div class="stat-content">
            <span class="stat-number">{{ stats.total_urls }}</span>
            <div class="stat-label">URLs Extracted</div>
        </div>
    </div>
    <div class="stat-card-large">
        <div class="stat-icon">
            <i class="fas fa-code"></i>
        </div>
        <div class="stat-content">
            <span class="stat-number">{{ stats.total_endpoints }}</span>
            <div class="stat-label">API Endpoints</div>
        </div>
    </div>
</div>

<!-- Recent Activity Section -->
<div class="dashboard-section">
    <div class="card full-width-card">
        <div class="card-header">
            <i class="fas fa-history"></i> Recent Scanning Activity
        </div>
        <div class="card-body">
            {% if recent_scans %}
            <div class="activity-grid">
                {% for scan in recent_scans %}
                <div class="activity-item">
                    <div class="activity-icon">
                        {% if scan.scan_type == 'url' %}
                            <i class="fas fa-globe"></i>
                        {% elif scan.scan_type == 'bulk_urls' %}
                            <i class="fas fa-list"></i>
                        {% else %}
                            <i class="fas fa-code"></i>
                        {% endif %}
                    </div>
                    <div class="activity-content">
                        <div class="activity-title">{{ scan.project.name }}</div>
                        <div class="activity-subtitle">{{ scan.url or scan.filename or 'Code Input' }}</div>
                        <div class="activity-meta">
                            <span class="badge {% if scan.status == 'completed' %}badge-success{% elif scan.status == 'failed' %}badge-danger{% else %}badge-warning{% endif %}">
                                {{ scan.status.title() }}
                            </span>
                            {% if scan.total_secrets > 0 %}
                                <span class="badge badge-warning">{{ scan.total_secrets }} secrets</span>
                            {% endif %}
                            <span class="activity-time">{{ scan.created_at.strftime('%Y-%m-%d %H:%M') }}</span>
                        </div>
                    </div>
                    <div class="activity-actions">
                        {% if scan.status == 'completed' %}
                        <a href="{{ url_for('scan_results', scan_id=scan.id) }}" class="btn btn-sm">
                            <i class="fas fa-eye"></i> View
                        </a>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="empty-state">
                <div class="empty-icon">
                    <i class="fas fa-search"></i>
                </div>
                <h3>No Scans Yet</h3>
                <p>Start your first scan to see activity here</p>
                <a href="{{ url_for('create_project') }}" class="btn">
                    <i class="fas fa-plus"></i> Create Project
                </a>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<!-- Quick Actions -->
<div class="dashboard-section">
    <div class="quick-actions-grid">
        <div class="card action-card">
            <div class="card-body text-center">
                <div class="action-icon">
                    <i class="fas fa-plus-circle"></i>
                </div>
                <h3>New Project</h3>
                <p>Create a new project to organize your scans</p>
                <a href="{{ url_for('create_project') }}" class="btn">Create Project</a>
            </div>
        </div>
        
        <div class="card action-card">
            <div class="card-body text-center">
                <div class="action-icon">
                    <i class="fas fa-search"></i>
                </div>
                <h3>Quick Scan</h3>
                <p>Start scanning JavaScript files immediately</p>
                <a href="{{ url_for('scan') }}" class="btn">Start Scan</a>
            </div>
        </div>
        
        <div class="card action-card">
            <div class="card-body text-center">
                <div class="action-icon">
                    <i class="fas fa-eye"></i>
                </div>
                <h3>JS Monitor</h3>
                <p>Monitor JavaScript files for changes</p>
                <a href="{{ url_for('create_monitor') }}" class="btn">Create Monitor</a>
            </div>
        </div>
        
        <div class="card action-card">
            <div class="card-body text-center">
                <div class="action-icon">
                    <i class="fas fa-cog"></i>
                </div>
                <h3>Settings</h3>
                <p>Configure notifications and preferences</p>
                <a href="{{ url_for('settings') }}" class="btn">Open Settings</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}
